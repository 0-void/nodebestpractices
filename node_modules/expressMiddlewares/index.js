"use strict";

const cookieParser = require("cookie-parser"),
  bodyParser = require("body-parser"),
  helmet = require("helmet"),
  CORSMiddleware = require("./middlewares/CORS"),
  configurationManager = require("configurationManager"),
  authenticationMiddlewares = require("./middlewares/authentication"),
  authenticatedRoutes = require("./middlewares/authenticatedRoutes");

class middlewaresPool {
  getCommonMiddlewares() {
    const result = [];
    result.push(helmet());
    result.push(bodyParser.json());
    result.push(bodyParser.urlencoded({ extended: true }));
    result.push(cookieParser(configurationManager.auth.app.cookiePhrase));
    result.push(CORSMiddleware);
    result.push(authenticationMiddlewares(passport));

    return result;
  }

  getAuthenticationMiddleware(){

  }

  getRoleBasedAuthorizationMiddleware(){

  }
}

module.exports = new middlewaresPool();